# Финансовый учет РПК Сталкер

Веб-приложение для ведения финансового учета компании с возможностью управления доходами, расходами, переводами, планированием платежей и генерацией отчетов.

## Возможности приложения

### Основные функции
- **Операции**: Создание и управление доходами, расходами и переводами между счетами
- **Справочники**: Управление счетами, категориями доходов/расходов, направлениями деятельности
- **Планирование**: Создание плановых операций с возможностью повторения
- **Отчеты**: Движение денежных средств, прибыли и убытки с фильтрацией по периодам
- **Роли пользователей**: Администратор (полный доступ) и Менеджер (ограниченный доступ)

### Дизайн
- Современный адаптивный интерфейс с использованием Tailwind CSS
- Цветовая схема: доходы (бледно-зеленый), расходы (бледно-розовый), акцент (вишневый)
- Интуитивная навигация и удобные формы

## Технологический стек

- **Backend**: Python Flask с SQLAlchemy ORM
- **Frontend**: HTML, CSS (Tailwind), JavaScript (Vanilla)
- **База данных**: SQLite (для разработки), PostgreSQL/MySQL (для продакшн)
- **API**: RESTful API с поддержкой CORS

## Установка и запуск

### Требования
- Python 3.8+
- pip (менеджер пакетов Python)

### Локальная установка

1. **Клонирование или загрузка проекта**
   ```bash
   # Если у вас есть архив, распакуйте его
   # Перейдите в директорию проекта
   cd financial_app
   ```

2. **Создание виртуального окружения**
   ```bash
   python -m venv venv
   
   # Активация (Windows)
   venv\Scripts\activate
   
   # Активация (Linux/Mac)
   source venv/bin/activate
   ```

3. **Установка зависимостей**
   ```bash
   pip install -r requirements.txt
   ```

4. **Запуск приложения**
   ```bash
   python src/main.py
   ```

5. **Открытие в браузере**
   Перейдите по адресу: http://localhost:5001

### Первый запуск

При первом открытии приложения автоматически создаются тестовые данные:
- Счета: Расчетный счет, Касса, Корпоративная карта
- Категории доходов: Выручка, Взнос собственных средств, Прочие доходы
- Категории расходов: Закупка материалов, Зарплата, Налоги, Аренда, Реклама
- Направления деятельности: Наружка, Внутреннее оформление, Полиграфия, Сувениры, Текстиль, Печати и штампы, Услуги

## Развертывание в облаке

### Heroku

1. **Подготовка файлов**
   Создайте файл `Procfile` в корне проекта:
   ```
   web: python src/main.py
   ```

2. **Установка Heroku CLI и развертывание**
   ```bash
   # Установите Heroku CLI с официального сайта
   heroku login
   heroku create your-app-name
   git init
   git add .
   git commit -m "Initial commit"
   git push heroku main
   ```

3. **Настройка базы данных**
   ```bash
   heroku addons:create heroku-postgresql:hobby-dev
   ```

### DigitalOcean App Platform

1. **Подключение репозитория**
   - Загрузите код в GitHub
   - Создайте новое приложение в DigitalOcean App Platform
   - Подключите ваш GitHub репозиторий

2. **Настройка**
   - Build Command: `pip install -r requirements.txt`
   - Run Command: `python src/main.py`
   - HTTP Port: 5001

### AWS Elastic Beanstalk

1. **Подготовка**
   Создайте файл `application.py` в корне:
   ```python
   from src.main import app
   
   if __name__ == "__main__":
       app.run()
   ```

2. **Развертывание**
   ```bash
   pip install awsebcli
   eb init
   eb create
   eb deploy
   ```

## Настройка для продакшн

### База данных

Для продакшн-среды рекомендуется использовать PostgreSQL. Измените строку подключения в `src/main.py`:

```python
# Замените SQLite на PostgreSQL
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql://username:password@host:port/database'
```

### Переменные окружения

Создайте файл `.env` для хранения конфиденциальных данных:
```
SECRET_KEY=your-secret-key-here
DATABASE_URL=postgresql://username:password@host:port/database
```

### Безопасность

1. Измените SECRET_KEY на случайную строку
2. Настройте HTTPS
3. Ограничьте CORS для конкретных доменов
4. Добавьте аутентификацию пользователей

## Структура проекта

```
financial_app/
├── src/
│   ├── main.py              # Основной файл приложения
│   ├── models/
│   │   ├── financial.py     # Модели базы данных
│   │   └── user.py          # Модель пользователя (legacy)
│   ├── routes/
│   │   ├── financial.py     # API маршруты для финансов
│   │   └── user.py          # API маршруты для пользователей
│   ├── static/
│   │   ├── index.html       # Основная HTML страница
│   │   └── js/
│   │       └── main.js      # JavaScript логика
│   └── database/
│       └── app.db           # SQLite база данных
├── venv/                    # Виртуальное окружение
├── requirements.txt         # Зависимости Python
└── README.md               # Данная инструкция
```

## API Endpoints

### Счета
- `GET /api/accounts` - Получить все счета
- `POST /api/accounts` - Создать новый счет
- `PUT /api/accounts/<id>` - Обновить счет
- `DELETE /api/accounts/<id>` - Деактивировать счет

### Операции
- `GET /api/transactions` - Получить операции (с фильтрами)
- `POST /api/transactions` - Создать новую операцию

### Плановые операции
- `GET /api/planned-transactions` - Получить плановые операции
- `POST /api/planned-transactions` - Создать плановую операцию
- `POST /api/planned-transactions/<id>/complete` - Выполнить плановую операцию

### Отчеты
- `GET /api/reports/cash-flow` - Отчет по движению ДС
- `GET /api/reports/profit-loss` - Отчет по прибылям и убыткам

### Справочники
- `GET /api/income-categories` - Категории доходов
- `GET /api/expense-categories` - Категории расходов
- `GET /api/business-directions` - Направления деятельности

## Поддержка

При возникновении проблем:
1. Проверьте логи приложения
2. Убедитесь, что все зависимости установлены
3. Проверьте настройки базы данных
4. Убедитесь, что порт 5001 не занят другими приложениями

## Лицензия

Данное приложение создано для внутреннего использования РПК Сталкер.

